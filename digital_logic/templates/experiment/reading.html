{% extends 'layouts/base.html' %}

{% set section_name = section.name %}
{% set exercises = section.exercises %}

{% block content %}
    <div class="row">
        <div class="col s12 m10 l10 offset-l1 offset-m1">
            <div class="card-panel">
                <div class="progress">
                    <div class="indeterminate"></div>
                </div>
                <div class="reading-wrapper loading">
                    <div class="textbook-text">
                        {{ text | safe }}
                    </div>
                    <div>
                        {% if not exercises %}
                        <form action="{{ url_for('exp.reading') }}">
                            <p class="right-align"><button type="submit" class="btn btn-large waves-effect waves-light">Next</button><br/><strong></strong></p>
                       </form>
                        {% else %}

                            <p class="exercise-button right-align"><button type="submit" class="btn btn-large waves-effect waves-light">Answer Exercises</button><br/>
                                <strong>
                                    You have some practice exercises coming up
                                </strong>
                            </p>

                        {% endif %}
                    </div>
                </div>
                <div class="exercise-wrapper" style="display:none">
                    <div class="exercise-text-area">
                        <div class="card-panel white-text teal">
                            Please take your time to answer the question.  Some questions
                            may require you to work the answers using a pen and paper.  Note
                            that some of the questions are designed to be a lot harder than
                            the rest.  Please try your hardest to answer these questions,
                            but don't let them discourage you from completing the study.
                        </div>
                        <div class="card-panel">
                            <div>
                                <div class="exercise-counter">Exercise <span class="current-exercise-counter">0</span> of <span class="total-exercises"></span>0</div>
                            </div>
                            <div>
                            <div class="exercise-text">Exercise Text Here

                            </div>
                                <form class="exercise-form">

                                <p class="right-align"><button type="submit" onClick="window.ExercisePhase.handleSubmit(event)" class="btn btn-large waves-effect waves-light">Submit</button><br/><strong></strong></p>
                                </form>
                                </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

{% endblock content %}

{% block scripts %}
    {{ super() }}
    {{ javascript_tag('exercise_js') | safe }}


    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          processEscapes: true
        }
      });

    </script>
    <script type="text/javascript"
            src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>

    <script>
        function loaded() {
          $('.reading-wrapper').removeClass('loading');
          $('.progress').hide()
        }

        function delayLoad() {
          MathJax.Hub.Queue(function() {
            loaded();
          });
          setTimeout(loaded, 500)
        }
        setTimeout(delayLoad, 800)
    </script>

    {% if exercises %}
    <script>
        $('.exercise-button').on('click', function() {
          window.ExercisePhase.start('{{section_name}}', '{{subject_id}}', '{{assignment_id}}')
        })
    </script>
    {% endif %}
{% endblock scripts %}
